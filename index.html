<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inventario Higiene Bucodental</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@500;700&family=Inter:wght@400;600;800&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc;
        }

        .search-container {
            position: sticky;
            top: 0;
            z-index: 50;
        }

        .qty-badge {
            font-family: 'JetBrains Mono', monospace;
            min-width: 90px;
            display: inline-block;
            text-align: center;
        }

        tr:nth-child(even) {
            background-color: #f1f5f9;
        }

        .item-row:hover {
            background-color: #e2e8f0 !important;
        }
    </style>
</head>
<body class="pb-12 text-slate-900">

    <div class="search-container bg-white border-b-2 border-slate-200 p-4 shadow-sm">
        <div class="max-w-5xl mx-auto flex items-center gap-6">
            <div class="flex-grow">
                <input type="text" id="searchInput" 
                       placeholder="Buscar material, especialidad o armario..." 
                       class="w-full px-4 py-3 bg-slate-100 border-2 border-transparent focus:border-blue-600 focus:bg-white rounded-lg outline-none transition-all font-semibold">
            </div>
            <div class="text-right">
                <span class="text-xs font-black text-slate-400 uppercase tracking-widest block">Total Items</span>
                <span id="totalItems" class="text-2xl font-black text-blue-600">0</span>
            </div>
        </div>
    </div>

    <div class="max-w-5xl mx-auto px-4 mt-8">
        <div id="inventoryContainer">
            </div>

        <div class="mt-12 bg-white border-2 border-amber-200 rounded-xl overflow-hidden shadow-sm" id="pedidosSection">
            <div class="bg-amber-500 px-6 py-3 font-black text-white tracking-wider">
                PEDIDOS PENDIENTES
            </div>
            <div class="p-0" id="pedidosContainer">
                </div>
        </div>
    </div>

    <script>
        const inventory = [
            // Armario 8
            { loc: "Armario 8", name: "Pantoma", qty: "2 uds", spec: "Prótesis" },
            { loc: "Armario 8", name: "Escayola", qty: "4 kg", spec: "Prótesis" },
            { loc: "Armario 8", name: "Papel de manos / Baberos", qty: "Gran cantidad", spec: "Higiene" },
            { loc: "Armario 8", name: "Tipodonto", qty: "5 uds", spec: "Preventiva" },
            { loc: "Armario 8", name: "Recambios dientes tipodonto", qty: "Varios", spec: "Preventiva" },
            { loc: "Armario 8", name: "Barreño plegable", qty: "1 ud", spec: "General" },
            
            // Armario 9
            { loc: "Armario 9", name: "Caja de ultrasonidos", qty: "1 ud", spec: "Higiene" },
            { loc: "Armario 9", name: "Kit Lámpara Polimerizar (Cable/Lámpara)", qty: "1 kit", spec: "Conservadora" },
            { loc: "Armario 9", name: "Joyas dentales", qty: "Varios", spec: "Estética" },
            { loc: "Armario 9", name: "Dispensadora vasos", qty: "1 ud", spec: "Higiene" },
            { loc: "Armario 9", name: "Limas Endodoncia", qty: "Varios", spec: "Endodoncia" },
            { loc: "Armario 9", name: "Bote Alcohol", qty: "1 ud", spec: "Higiene" },

            // Armario 7
            { loc: "Armario 7", name: "Póster anatomía", qty: "1 ud", spec: "General" },
            { loc: "Armario 7", name: "Desinfectante superficies (Verde)", qty: "Varios", spec: "Higiene" },
            { loc: "Armario 7", name: "Alcohol", qty: "Varios", spec: "Higiene" },
            { loc: "Armario 7", name: "Desatascador", qty: "1 ud", spec: "Mantenimiento" },

            // Armario 6
            { loc: "Armario 6", name: "Agua destilada 5L", qty: "3 botellas", spec: "Higiene" },
            { loc: "Armario 6", name: "Mascarillas Negras", qty: "18 pq (180 uds)", spec: "EPI" },
            { loc: "Armario 6", name: "Guantes Talla S", qty: "2 cajas (67 uds)", spec: "EPI" },
            { loc: "Armario 6", name: "Guantes Talla M", qty: "1 caja", spec: "EPI" },
            { loc: "Armario 6", name: "Guantes Talla L", qty: "3 cajas", spec: "EPI" },
            { loc: "Armario 6", name: "Patucos", qty: "Varios", spec: "EPI" },

            // Cajón 9
            { loc: "Cajón 9", name: "Alginato", qty: "1 paquete", spec: "Prótesis" },
            { loc: "Cajón 9", name: "Pastillas reveladoras Hager", qty: "50 pastillas", spec: "Preventiva" },
            { loc: "Cajón 9", name: "Cubetas de flúor", qty: "Varios", spec: "Preventiva" },
            { loc: "Cajón 9", name: "Cubetas impresión (Estériles/Sin)", qty: "Varios", spec: "Prótesis" },
            { loc: "Cajón 9", name: "Tazas mezcla alginato", qty: "Varios", spec: "Prótesis" },
            { loc: "Cajón 9", name: "Silicona pesada", qty: "Varios", spec: "Prótesis" },
            { loc: "Cajón 9", name: "Silicona fluida", qty: "Varios", spec: "Prótesis" },
            { loc: "Cajón 9", name: "Puntas silicona fluida", qty: "Varios", spec: "Prótesis" },
            { loc: "Cajón 9", name: "Espátula alginato", qty: "Varios", spec: "Prótesis" },

            // Cajón 10
            { loc: "Cajón 10", name: "Papel articular", qty: "1 caja", spec: "Conservadora" },
            { loc: "Cajón 10", name: "Polerstrips", qty: "2 cajas", spec: "Conservadora" },
            { loc: "Cajón 10", name: "Cepillos profilácticos", qty: "Varios", spec: "Preventiva" },
            { loc: "Cajón 10", name: "Cemento Zinc (Polvo)", qty: "2 botes", spec: "Conservadora" },
            { loc: "Cajón 10", name: "Cemento Coronas Dyract", qty: "Varios", spec: "Conservadora" },
            { loc: "Cajón 10", name: "Adhesivo empastes", qty: "Varios", spec: "Conservadora" },
            { loc: "Cajón 10", name: "Matrices metálicas", qty: "3 uds", spec: "Conservadora" },
            { loc: "Cajón 10", name: "Matrices transparentes", qty: "3 uds", spec: "Conservadora" },
            { loc: "Cajón 10", name: "Hidróxido Calcio", qty: "2 tubos", spec: "Conservadora" },
            { loc: "Cajón 10", name: "Composite fluido", qty: "3 botes", spec: "Conservadora" },
            { loc: "Cajón 10", name: "Pasta pulir composite", qty: "1 bote", spec: "Conservadora" },
            { loc: "Cajón 10", name: "Acrílico coronas prov.", qty: "1 bote", spec: "Prótesis" },
            { loc: "Cajón 10", name: "Ligaduras Kobayashi", qty: "Varios", spec: "Ortodoncia" },
            { loc: "Cajón 10", name: "Papel pH salival", qty: "2 tiras", spec: "Preventiva" },
            { loc: "Cajón 10", name: "Pocillos (Reutilizables/Desechables)", qty: "Muchos", spec: "Higiene" },

            // Cajón 11-12
            { loc: "Cajón 11", name: "Dientes e Instrucciones Termoselladora", qty: "Varios", spec: "Prótesis" },
            { loc: "Cajón 11", name: "Incubadora de esporas", qty: "1 caja", spec: "Mantenimiento" },
            { loc: "Cajón 12", name: "Fresas pieza mano", qty: "Varios", spec: "Prótesis" },
            { loc: "Cajón 12", name: "Discos pulir prótesis", qty: "Varios", spec: "Prótesis" },
            { loc: "Cajón 12", name: "Casquillos Aluminio", qty: "5 cajas", spec: "Prótesis" },

            // Armario 4-5
            { loc: "Armario 4", name: "Gel flúor para cubetas", qty: "2 botes", spec: "Preventiva" },
            { loc: "Armario 4", name: "Pasta de dientes", qty: "7 cajas", spec: "Higiene" },
            { loc: "Armario 4", name: "Hilo dental", qty: "2 uds", spec: "Higiene" },
            { loc: "Armario 4", name: "Vibrador yeso / Maq. Vacío", qty: "1 ud", spec: "Laboratorio" },
            { loc: "Armario 4", name: "Placas retenedores (Duras/Rígidas)", qty: "3 uds", spec: "Ortodoncia" },
            { loc: "Armario 5", name: "Mascarillas (Infantiles/Suplemento)", qty: "Ilimitado", spec: "EPI" },

            // Cajón 5-8
            { loc: "Cajón 5", name: "Guantes estériles", qty: "18 pares", spec: "EPI" },
            { loc: "Cajón 5", name: "Baberos", qty: "5 pq", spec: "Higiene" },
            { loc: "Cajón 6", name: "Bandejas pocillos desechables", qty: "7 pq", spec: "Higiene" },
            { loc: "Cajón 7", name: "Guías de color / Ceras mordida", qty: "Varios", spec: "Prótesis" },
            { loc: "Cajón 8", name: "Alicates ortodoncia (Estériles)", qty: "Varios", spec: "Ortodoncia" },
            { loc: "Cajón 8", name: "Fórceps extracción infantil", qty: "Varios", spec: "Cirugía" },
            { loc: "Cajón 8", name: "Agujas Anestesia Cortas", qty: "6 cajas", spec: "Cirugía" },
            { loc: "Cajón 8", name: "Agujas Anestesia Largas", qty: "1 caja", spec: "Cirugía" },
            { loc: "Cajón 8", name: "Suturas (Agujas/Piel artificial)", qty: "Varios", spec: "Cirugía" },
            { loc: "Cajón 8", name: "Bisturí (Mangos/Hojas)", qty: "Varios", spec: "Cirugía" }
        ];

        const pedidos = [
            { name: "Pistola para silicona fluida", qty: "1 ud" },
            { name: "Rollos de papel", qty: "4 rollos" }
        ];

        // Función para ordenar: Primero Armarios (menor a mayor) y luego Cajones (menor a mayor)
        function customSort(data) {
            return data.sort((a, b) => {
                const getParts = (s) => {
                    const match = s.match(/([a-zA-Záéíóú]+)\s*(\d+)/i);
                    return match ? { text: match[1], num: parseInt(match[2]) } : { text: s, num: 0 };
                };
                
                const aP = getParts(a.loc);
                const bP = getParts(b.loc);

                // Forzar "Armario" antes que "Cajón" independientemente del alfabeto
                if (aP.text !== bP.text) {
                    return aP.text === "Armario" ? -1 : 1;
                }
                // Si son iguales (ej. ambos Armarios), ordenar por número
                return aP.num - bP.num;
            });
        }

        function renderInventory(filter = "") {
            const container = document.getElementById('inventoryContainer');
            container.innerHTML = "";
            
            const sortedData = customSort([...inventory]);
            
            // Agrupar
            const grouped = sortedData.reduce((acc, item) => {
                if (!acc[item.loc]) acc[item.loc] = [];
                acc[item.loc].push(item);
                return acc;
            }, {});

            let visibleCount = 0;

            // Renderizar manteniendo el orden de las llaves del objeto agrupado
            // (que ya vienen ordenadas por haber ordenado el array original)
            Object.keys(grouped).forEach(loc => {
                const filteredItems = grouped[loc].filter(i => 
                    i.name.toLowerCase().includes(filter.toLowerCase()) || 
                    i.spec.toLowerCase().includes(filter.toLowerCase())
                );

                if (filteredItems.length > 0) {
                    const section = document.createElement('div');
                    section.className = "mb-8 bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden";
                    
                    let rows = filteredItems.map(item => {
                        visibleCount++;
                        return `
                        <tr class="item-row border-b border-slate-100 last:border-0 transition-colors">
                            <td class="py-4 px-6">
                                <div class="font-extrabold text-slate-800 text-lg">${item.name}</div>
                                <div class="text-[10px] font-bold text-slate-400 uppercase tracking-widest mt-0.5">${item.spec}</div>
                            </td>
                            <td class="py-4 px-6 text-right">
                                <span class="qty-badge bg-blue-600 text-white px-4 py-2 rounded-lg text-sm font-black shadow-sm">
                                    ${item.qty}
                                </span>
                            </td>
                        </tr>`;
                    }).join('');

                    section.innerHTML = `
                        <div class="bg-slate-800 text-white px-6 py-3 text-sm font-black uppercase tracking-[0.2em] flex justify-between items-center">
                            <span>${loc}</span>
                            <span class="text-[10px] bg-slate-600 px-3 py-1 rounded-full uppercase">${filteredItems.length} materiales</span>
                        </div>
                        <table class="w-full text-left border-collapse">
                            <tbody>${rows}</tbody>
                        </table>
                    `;
                    container.appendChild(section);
                }
            });
            document.getElementById('totalItems').innerText = visibleCount;
        }

        function renderPedidos() {
            const container = document.getElementById('pedidosContainer');
            container.innerHTML = pedidos.map(p => `
                <div class="flex justify-between items-center px-6 py-4 border-b border-slate-100 last:border-0">
                    <span class="font-extrabold text-slate-700">${p.name}</span>
                    <span class="bg-amber-100 text-amber-700 border border-amber-200 px-3 py-1 rounded-md text-xs font-black">${p.qty}</span>
                </div>
            `).join('');
        }

        document.getElementById('searchInput').addEventListener('input', (e) => {
            renderInventory(e.target.value);
            document.getElementById('pedidosSection').classList.toggle('hidden', e.target.value !== "");
        });

        // Inicio
        renderInventory();
        renderPedidos();
    </script>
</body>
</html>
